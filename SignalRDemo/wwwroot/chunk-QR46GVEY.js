import{$ as A,C,D as O,E as _,F as y,H as I,I as D,J as U,L as b,M as F,S as M,T as L,U as T,W as E,X as w,Y as G,Z as j,aa as z}from"./chunk-QRNUQSJE.js";import{Fc as h,Gb as u,Gc as x,Qb as a,Sb as f,Tb as g,Ua as r,Va as m,Yb as S,fa as d,jb as p,ob as l,xb as i,yb as o,zb as v}from"./chunk-62WP7Q22.js";import"./chunk-RNMDN42R.js";function N(t,c){if(t&1&&(i(0,"mat-toolbar",4)(1,"mat-toolbar-row")(2,"mat-card",5)(3,"div"),a(4),o(),i(5,"div"),a(6),o()()()()),t&2){let e=u();r(4),f("Welcome, ",e.appService.userData.name,""),r(2),f(" Connection ID: ",e.appService.userData.signalrId," ")}}function k(t,c){if(t&1&&(i(0,"mat-list-item",7)(1,"h3",8),a(2),o()()),t&2){let e=c.$implicit;r(2),g("",e==null?null:e.name,", ID: ",e==null?null:e.signalrId,"")}}function H(t,c){if(t&1&&(i(0,"mat-list"),p(1,k,3,2,"mat-list-item",6),o()),t&2){let e=u();r(),l("ngForOf",e.usersOnline)}}function R(t,c){t&1&&(i(0,"p"),a(1,"No users are currently online."),o())}var Z=(()=>{class t{signalrService;logoutService;appService;usersOnline=new Array;constructor(e,n,s){this.signalrService=e,this.logoutService=n,this.appService=s}ngOnDestroy(){this.signalrService.offConnection(this.logoutService.successCommand)}ngOnInit(){this.userOnline(),this.userOffline(),this.getOnlineUsers(),this.signalrService.hasConnection()?this.getOnlineUsersInv():this.signalrService.signalrSubject$.subscribe(e=>{e.type=="HubConnectionStarted"&&this.getOnlineUsersInv()})}userOnline(){try{this.signalrService.hubConnection.on("User_Online",e=>{this.usersOnline.push(e)})}catch(e){console.log(e)}}userOffline(){try{this.signalrService.hubConnection.on("User_Offline",e=>{this.usersOnline=this.usersOnline.filter(n=>n.id!=e)})}catch(e){console.log(e)}}getOnlineUsersInv(){this.signalrService.hubConnection.invoke("GetOnlineUsers").catch(e=>console.error(e))}getOnlineUsers(){this.signalrService.hubConnection.on("GetOnlineUsers_Response",e=>{this.usersOnline=[...e]})}static \u0275fac=function(n){return new(n||t)(m(A),m(z),m(j))};static \u0275cmp=d({type:t,selectors:[["app-user-connection-state"]],standalone:!0,features:[S],decls:10,vars:3,consts:[["fxLayout","column","fxFlexFill",""],["color","primary",4,"ngIf"],[2,"margin-top","26px"],[4,"ngIf"],["color","primary"],["fxLayout","row","fxLayoutAlign","space-around center","fxFlex","100%","fxLayoutGap","20px",2,"color","black"],["style","font-size: 14px;",4,"ngFor","ngForOf"],[2,"font-size","14px"],["matLine","",2,"font-size","16px","margin","0"]],template:function(n,s){n&1&&(i(0,"div",0),p(1,N,7,2,"mat-toolbar",1),i(2,"mat-card",2)(3,"mat-card-header")(4,"mat-card-title"),a(5,"Online Users"),o()(),v(6,"mat-divider"),i(7,"mat-card-content"),p(8,H,2,1,"mat-list",3)(9,R,2,0,"p",3),o()()()),n&2&&(r(),l("ngIf",s.appService.userData),r(7),l("ngIf",s.usersOnline.length>0),r(),l("ngIf",s.usersOnline.length===0))},dependencies:[G,h,x,C,_,y,O,D,U,I,F,b,M,L,w,E,T]})}return t})();export{Z as UserConnectionStateComponent};
